#!/usr/bin/env php
<?php

use Symfony\Bundle\MonologBundle\DependencyInjection\Compiler\LoggerChannelPass;
use Symfony\Bundle\MonologBundle\DependencyInjection\MonologExtension;
use Symfony\Component\Config\FileLocator;
use Symfony\Component\Console\Application;
use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\DependencyInjection\Loader\YamlFileLoader;

require __DIR__ . '/../vendor/autoload.php';

$container = new ContainerBuilder();
$container->registerExtension(new MonologExtension());
$container->addCompilerPass(new LoggerChannelPass());

$loader = new YamlFileLoader($container, new FileLocator(__DIR__ . '/../app/config'));
$loader->load('config.yml');

$container->compile();

$application = new Application('update-dns', '1.0.0');
$command = $container->get('dns_update_command');

$application->add($command);
$application->setDefaultCommand($command->getName(), true);
$application->run();
